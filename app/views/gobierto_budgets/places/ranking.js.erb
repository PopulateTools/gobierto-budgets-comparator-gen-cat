$('#ranking-table').replaceWith("<%= j(render partial: 'gobierto_budgets/places/ranking_table') %>")
$('.pagination').replaceWith("<%= j(paginate @ranking_items, remote: true) %>")

function updatePageUrl() {
  history.pushState({ turbolinks: {} }, '', "<%= request.url %>");
}

function updateDataEndpointPath() {
  $('[data-ranking-url]').data('ranking-url', "<%= request.path %>");
}

function updateExistingLinksWithNewFilters() {
  $('.js-ranking-link').each(function() {
    var auxLink = document.createElement("a");
    auxLink.href = this.href;

    var newParams = '<%= URI.decode({ f: params[:f] }.to_query).html_safe %>';

    this.href = auxLink.origin + auxLink.pathname + '?' + newParams;
  });
}

updatePageUrl();
updateDataEndpointPath();
updateExistingLinksWithNewFilters();
